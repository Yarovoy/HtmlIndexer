<?xml version="1.0"?>
<s:WindowedApplication xmlns:fx="http://ns.adobe.com/mxml/2009"
                       xmlns:s="library://ns.adobe.com/flex/spark"
                       xmlns:maps="htmlIndexer.mate.maps.*"
                       xmlns:validators="htmlIndexer.validators.*">
	<fx:Script><![CDATA[
		import htmlIndexer.mate.events.HtmlIndexerEvent;

		import mx.events.ValidationResultEvent;

		private function validateUrlAndDispatchIndexPageEvent():void
		{
			const validationResult:ValidationResultEvent = urlValidator.validate();
			if (validationResult.type == ValidationResultEvent.INVALID)
			{
				urlValidator.triggerEvent = Event.CHANGE;
				return;
			}

			urlValidator.triggerEvent = '';

			dispatchEvent(
					new HtmlIndexerEvent(
							HtmlIndexerEvent.INDEX_PAGE,
							urlTextInput.text
					)
			);
		}
		]]></fx:Script>

	<fx:Declarations>
		<maps:HtmlIndexerEventMap />

		<validators:URLValidator id="urlValidator"
		                         source="{urlTextInput}"
		                         property="text"
		                         triggerEvent="" />
	</fx:Declarations>

	<s:layout>
		<s:VerticalLayout
				paddingTop="20" paddingLeft="20"
				paddingBottom="20" paddingRight="20"
				gap="20" />
	</s:layout>

	<s:HGroup width="100%">
		<s:Label text="URL:"
		         fontSize="24" />

		<s:TextInput id="urlTextInput"
		             width="100%"
		             text="http://ya.ru"
		             prompt="Enter an URLâ€¦"
		             enter="validateUrlAndDispatchIndexPageEvent();" />

		<s:Button id="indexingButton"
		          label="OK"
		          click="validateUrlAndDispatchIndexPageEvent();" />
	</s:HGroup>

	<s:DataGrid id="linksDataGrid" width="100%" height="100%" />

	<s:Group width="100%">
		<s:Button id="exportCsvButton"
		          label="Export to CSV"
		          right="0" bottom="0"
		          click="dispatchEvent(new HtmlIndexerEvent(HtmlIndexerEvent.EXPORT_CSV))" />
	</s:Group>

</s:WindowedApplication>
